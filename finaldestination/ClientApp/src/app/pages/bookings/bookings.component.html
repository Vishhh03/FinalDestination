<app-navbar></app-navbar>

<div class="page-header">
  <div class="container">
    <h1>My Bookings</h1>
    <p>Manage your hotel reservations</p>
  </div>
</div>

<section class="bookings-section">
  <div class="container">
    @if (error()) {
      <div class="alert alert-error">
        <i class="fas fa-exclamation-circle"></i> {{ error() }}
      </div>
    }
    
    @if (success()) {
      <div class="alert alert-success">
        <i class="fas fa-check-circle"></i> {{ success() }}
      </div>
    }
    
    <div class="bookings-list">
      @for (booking of bookings(); track booking.id) {
        <div class="booking-card">
          <div class="booking-header">
            <h3>{{ booking.hotelName }}</h3>
            <span class="booking-status" [class]="'status-' + booking.status.toString().toLowerCase()">
              {{ booking.status }}
            </span>
          </div>
          <div class="booking-details">
            <div class="detail-item">
              <i class="fas fa-calendar-check"></i>
              <span>Check-in: {{ booking.checkInDate | date:'mediumDate' }}</span>
            </div>
            <div class="detail-item">
              <i class="fas fa-calendar-times"></i>
              <span>Check-out: {{ booking.checkOutDate | date:'mediumDate' }}</span>
            </div>
            <div class="detail-item">
              <i class="fas fa-users"></i>
              <span>Guests: {{ booking.numberOfGuests }}</span>
            </div>
            <div class="detail-item">
              <i class="fas fa-indian-rupee-sign"></i>
              <span>Total: {{ booking.totalAmount }}</span>
            </div>
          </div>
          <div class="booking-actions">
            @if (booking.status === 'Confirmed') {
              <button (click)="openPaymentModal(booking)" class="btn-pay">
                <i class="fas fa-credit-card"></i> Pay Now
              </button>
              <button (click)="cancelBooking(booking.id)" class="btn-cancel">
                <i class="fas fa-times"></i> Cancel
              </button>
            }
          </div>
        </div>
      }
    </div>
    
    @if (bookings().length === 0) {
      <div class="no-bookings">
        <i class="fas fa-calendar-alt"></i>
        <p>You don't have any bookings yet</p>
        <a routerLink="/hotels" class="btn-primary">Browse Hotels</a>
      </div>
    }
  </div>
</section>

@if (showPaymentModal()) {
  <div class="modal">
    <div class="modal-overlay" (click)="closePaymentModal()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h2>Payment Details</h2>
        <button class="modal-close" (click)="closePaymentModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form (ngSubmit)="processPayment()" class="payment-form">
        <div class="form-group">
          <label>Amount</label>
          <input type="text" [(ngModel)]="paymentData.amount" name="amount" readonly>
        </div>

        <div class="form-group">
          <label>Card Number</label>
          <input 
            type="text"
            [(ngModel)]="paymentData.cardNumber"
            name="cardNumber"
            placeholder="1234 5678 9012 3456"
            required
          >
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Expiry Month</label>
            <input 
              type="number"
              [(ngModel)]="paymentData.expiryMonth"
              name="expiryMonth"
              placeholder="MM"
              min="1"
              max="12"
              required
            >
          </div>

          <div class="form-group">
            <label>Expiry Year</label>
            <input 
              type="number"
              [(ngModel)]="paymentData.expiryYear"
              name="expiryYear"
              placeholder="YYYY"
              min="2024"
              required
            >
          </div>

          <div class="form-group">
            <label>CVV</label>
            <input 
              type="text"
              [(ngModel)]="paymentData.cvv"
              name="cvv"
              placeholder="123"
              maxlength="4"
              required
            >
          </div>
        </div>

        <div class="form-group">
          <label>Cardholder Name</label>
          <input 
            type="text"
            [(ngModel)]="paymentData.cardHolderName"
            name="cardHolderName"
            placeholder="John Doe"
            required
          >
        </div>

        <button type="submit" class="btn-submit">Process Payment</button>
      </form>


    </div>
  </div>
}
